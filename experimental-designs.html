<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Experimental Designs | R Reference Sheet for CRSS 8010</title>
  <meta name="description" content="Basic R reference document for CRSS 8010" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Experimental Designs | R Reference Sheet for CRSS 8010" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://wallacelab.uga.edu/class/r-reference/" />
  
  <meta property="og:description" content="Basic R reference document for CRSS 8010" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Experimental Designs | R Reference Sheet for CRSS 8010" />
  
  <meta name="twitter:description" content="Basic R reference document for CRSS 8010" />
  

<meta name="author" content="Jason G. Wallace" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-regression.html"/>
<link rel="next" href="plotting-tools.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Reference Sheet for CRSS 8010</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>1</b> R Basics</a><ul>
<li class="chapter" data-level="1.1" data-path="r-basics.html"><a href="r-basics.html#data-types"><i class="fa fa-check"></i><b>1.1</b> Data types</a></li>
<li class="chapter" data-level="1.2" data-path="r-basics.html"><a href="r-basics.html#vectors"><i class="fa fa-check"></i><b>1.2</b> Vectors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-basics.html"><a href="r-basics.html#c"><i class="fa fa-check"></i><b>1.2.1</b> c()</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-basics.html"><a href="r-basics.html#length"><i class="fa fa-check"></i><b>1.2.2</b> length()</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-basics.html"><a href="r-basics.html#class"><i class="fa fa-check"></i><b>1.2.3</b> class()</a></li>
<li class="chapter" data-level="1.2.4" data-path="r-basics.html"><a href="r-basics.html#as.____"><i class="fa fa-check"></i><b>1.2.4</b> as.____()</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-basics.html"><a href="r-basics.html#matrices"><i class="fa fa-check"></i><b>1.3</b> Matrices</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-basics.html"><a href="r-basics.html#matrix"><i class="fa fa-check"></i><b>1.3.1</b> matrix()</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-basics.html"><a href="r-basics.html#matrix-dimensions-dim-nrow-and-ncol"><i class="fa fa-check"></i><b>1.3.2</b> Matrix dimensions: dim(), nrow() and ncol()</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-basics.html"><a href="r-basics.html#data-frames"><i class="fa fa-check"></i><b>1.4</b> Data frames</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-basics.html"><a href="r-basics.html#data.frame"><i class="fa fa-check"></i><b>1.4.1</b> data.frame()</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-basics.html"><a href="r-basics.html#dim-nrow-and-ncol"><i class="fa fa-check"></i><b>1.4.2</b> dim(), nrow() and ncol()</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-basics.html"><a href="r-basics.html#names"><i class="fa fa-check"></i><b>1.4.3</b> names()</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-basics.html"><a href="r-basics.html#lists"><i class="fa fa-check"></i><b>1.5</b> Lists</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-basics.html"><a href="r-basics.html#list"><i class="fa fa-check"></i><b>1.5.1</b> list()</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-basics.html"><a href="r-basics.html#reading-and-writing-data"><i class="fa fa-check"></i><b>1.6</b> Reading and writing data</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-basics.html"><a href="r-basics.html#scan"><i class="fa fa-check"></i><b>1.6.1</b> scan()</a></li>
<li class="chapter" data-level="1.6.2" data-path="r-basics.html"><a href="r-basics.html#read.table-and-read.csv"><i class="fa fa-check"></i><b>1.6.2</b> read.table() and read.csv()</a></li>
<li class="chapter" data-level="1.6.3" data-path="r-basics.html"><a href="r-basics.html#write.table-and-write.csv"><i class="fa fa-check"></i><b>1.6.3</b> write.table() and write.csv()</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-basics.html"><a href="r-basics.html#boolean-expressions"><i class="fa fa-check"></i><b>1.7</b> Boolean expressions</a><ul>
<li class="chapter" data-level="1.7.1" data-path="r-basics.html"><a href="r-basics.html#basic-comparison-operators"><i class="fa fa-check"></i><b>1.7.1</b> Basic comparison operators</a></li>
<li class="chapter" data-level="1.7.2" data-path="r-basics.html"><a href="r-basics.html#missing-and-non-finite-values"><i class="fa fa-check"></i><b>1.7.2</b> Missing and non-finite values</a></li>
<li class="chapter" data-level="1.7.3" data-path="r-basics.html"><a href="r-basics.html#boolean-operators"><i class="fa fa-check"></i><b>1.7.3</b> Boolean operators</a></li>
<li class="chapter" data-level="1.7.4" data-path="r-basics.html"><a href="r-basics.html#subsetting-with-boolean-expressions"><i class="fa fa-check"></i><b>1.7.4</b> Subsetting with boolean expressions</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="r-basics.html"><a href="r-basics.html#other-utility-functions"><i class="fa fa-check"></i><b>1.8</b> Other utility functions</a><ul>
<li class="chapter" data-level="1.8.1" data-path="r-basics.html"><a href="r-basics.html#head-and-tail"><i class="fa fa-check"></i><b>1.8.1</b> head() and tail()</a></li>
<li class="chapter" data-level="1.8.2" data-path="r-basics.html"><a href="r-basics.html#str"><i class="fa fa-check"></i><b>1.8.2</b> str()</a></li>
<li class="chapter" data-level="1.8.3" data-path="r-basics.html"><a href="r-basics.html#paste"><i class="fa fa-check"></i><b>1.8.3</b> paste()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>2</b> ANOVA</a><ul>
<li class="chapter" data-level="2.1" data-path="anova.html"><a href="anova.html#aov"><i class="fa fa-check"></i><b>2.1</b> aov()</a></li>
<li class="chapter" data-level="2.2" data-path="anova.html"><a href="anova.html#anova-1"><i class="fa fa-check"></i><b>2.2</b> anova()</a></li>
<li class="chapter" data-level="2.3" data-path="anova.html"><a href="anova.html#anova-2"><i class="fa fa-check"></i><b>2.3</b> Anova()</a></li>
<li class="chapter" data-level="2.4" data-path="anova.html"><a href="anova.html#tukey_tests"><i class="fa fa-check"></i><b>2.4</b> Tukey tests</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#lm"><i class="fa fa-check"></i><b>3.1</b> lm()</a></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#random-effects-and-lme4"><i class="fa fa-check"></i><b>3.2</b> Random effects and lme4</a><ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#extracting-blues-and-blups"><i class="fa fa-check"></i><b>3.2.1</b> Extracting BLUEs and BLUPs</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#lmertest"><i class="fa fa-check"></i><b>3.3</b> lmerTest</a></li>
<li class="chapter" data-level="3.4" data-path="linear-regression.html"><a href="linear-regression.html#em-means"><i class="fa fa-check"></i><b>3.4</b> EM-Means</a><ul>
<li class="chapter" data-level="3.4.1" data-path="linear-regression.html"><a href="linear-regression.html#cld"><i class="fa fa-check"></i><b>3.4.1</b> CLD()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="experimental-designs.html"><a href="experimental-designs.html"><i class="fa fa-check"></i><b>4</b> Experimental Designs</a><ul>
<li class="chapter" data-level="4.1" data-path="experimental-designs.html"><a href="experimental-designs.html#factorial-designs"><i class="fa fa-check"></i><b>4.1</b> Factorial designs</a></li>
<li class="chapter" data-level="4.2" data-path="experimental-designs.html"><a href="experimental-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>4.2</b> Completely randomized design</a></li>
<li class="chapter" data-level="4.3" data-path="experimental-designs.html"><a href="experimental-designs.html#randomized-complete-block-designs"><i class="fa fa-check"></i><b>4.3</b> Randomized complete block designs</a></li>
<li class="chapter" data-level="4.4" data-path="experimental-designs.html"><a href="experimental-designs.html#latin-squares"><i class="fa fa-check"></i><b>4.4</b> Latin Squares</a></li>
<li class="chapter" data-level="4.5" data-path="experimental-designs.html"><a href="experimental-designs.html#graeco-latin-squares"><i class="fa fa-check"></i><b>4.5</b> Graeco-Latin Squares</a></li>
<li class="chapter" data-level="4.6" data-path="experimental-designs.html"><a href="experimental-designs.html#balanced-incomplete-block-designs"><i class="fa fa-check"></i><b>4.6</b> Balanced Incomplete Block Designs</a></li>
<li class="chapter" data-level="4.7" data-path="experimental-designs.html"><a href="experimental-designs.html#confounded-designs"><i class="fa fa-check"></i><b>4.7</b> Confounded designs</a></li>
<li class="chapter" data-level="4.8" data-path="experimental-designs.html"><a href="experimental-designs.html#split-plot-designs"><i class="fa fa-check"></i><b>4.8</b> Split-plot designs</a></li>
<li class="chapter" data-level="4.9" data-path="experimental-designs.html"><a href="experimental-designs.html#strip-plot-designs"><i class="fa fa-check"></i><b>4.9</b> Strip-plot designs</a></li>
<li class="chapter" data-level="4.10" data-path="experimental-designs.html"><a href="experimental-designs.html#augmented-designs"><i class="fa fa-check"></i><b>4.10</b> Augmented designs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotting-tools.html"><a href="plotting-tools.html"><i class="fa fa-check"></i><b>5</b> Plotting Tools</a><ul>
<li class="chapter" data-level="5.1" data-path="plotting-tools.html"><a href="plotting-tools.html#scatterplots"><i class="fa fa-check"></i><b>5.1</b> Scatterplots</a></li>
<li class="chapter" data-level="5.2" data-path="plotting-tools.html"><a href="plotting-tools.html#histograms"><i class="fa fa-check"></i><b>5.2</b> Histograms</a></li>
<li class="chapter" data-level="5.3" data-path="plotting-tools.html"><a href="plotting-tools.html#boxplots"><i class="fa fa-check"></i><b>5.3</b> Boxplots</a></li>
<li class="chapter" data-level="5.4" data-path="plotting-tools.html"><a href="plotting-tools.html#violin-plots"><i class="fa fa-check"></i><b>5.4</b> Violin plots</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Reference Sheet for CRSS 8010</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="experimental-designs" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Experimental Designs</h1>
<p>These are the various designs we have covered in class, with quick notes about how to create them and how to analyze them. This is meant to be a quick cheat-sheet; for a full explanation, see the lecture notes. Most of these designs can be created using the <a href="https://cran.r-project.org/web/packages/agricolae">agricolae</a> package. The output from agricolae’s design.____() family of functions has a lot of useful information, but the part you’re probably most interested in are the $book and $sketch parts, which have a data table and field layout of the experiment. (Not all designs generate a $sketch component.)</p>
<p><strong>Note on randomization:</strong> Remember to use set.seed() to set your random seed before randomizing your design. This will let you recreate it in case something ever goes wrong. Just be sure to use a different random seed if you need a different randomization (e.g., doing the same experiment the next year.)</p>
<div id="factorial-designs" class="section level2">
<h2><span class="header-section-number">4.1</span> Factorial designs</h2>
<p>Factorial designs aren’t really a separate design, since ‘factorial’ just means you’re making all possible combinations of two (or more) treatments. As such, any design can be a factorial design. Just make sure you put all your treatments (and any interactions you’re interested in) into your models.</p>
</div>
<div id="completely-randomized-design" class="section level2">
<h2><span class="header-section-number">4.2</span> Completely randomized design</h2>
<p>CRDs are the simplest design where you just have replicates of your treatments arranged randomly in your experiment.</p>
<p>You can make a CRD in basic R using the rep() and sample() functions to replicate and randomize your samples, respectively.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="experimental-designs.html#cb36-1"></a><span class="op">&gt;</span><span class="st"> </span>treatments=LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] <span class="co"># Define treatments</span></span>
<span id="cb36-2"><a href="experimental-designs.html#cb36-2"></a><span class="op">&gt;</span><span class="st"> </span>design =<span class="st"> </span><span class="kw">rep</span>(treatments, <span class="dv">3</span>) <span class="co"># 3 replicates of each treatment</span></span>
<span id="cb36-3"><a href="experimental-designs.html#cb36-3"></a><span class="op">&gt;</span><span class="st"> </span>design =<span class="st"> </span><span class="kw">sample</span>(design, <span class="dt">replace=</span>F) <span class="co"># By default, sample() will make a sample the same size as what you give it</span></span>
<span id="cb36-4"><a href="experimental-designs.html#cb36-4"></a><span class="op">&gt;</span><span class="st"> </span>design</span>
<span id="cb36-5"><a href="experimental-designs.html#cb36-5"></a><span class="co">##  [1] &quot;B&quot; &quot;A&quot; &quot;D&quot; &quot;D&quot; &quot;G&quot; &quot;J&quot; &quot;I&quot; &quot;C&quot; &quot;A&quot; &quot;I&quot; &quot;J&quot; &quot;F&quot; &quot;D&quot; &quot;H&quot; &quot;J&quot; &quot;H&quot; &quot;B&quot; &quot;F&quot; &quot;I&quot;</span></span>
<span id="cb36-6"><a href="experimental-designs.html#cb36-6"></a><span class="co">## [20] &quot;F&quot; &quot;B&quot; &quot;E&quot; &quot;G&quot; &quot;E&quot; &quot;E&quot; &quot;A&quot; &quot;C&quot; &quot;H&quot; &quot;C&quot; &quot;G&quot;</span></span></code></pre></div>
<p>You can also use design.crd() from agricolae to do the same thing</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="experimental-designs.html#cb37-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(agricolae)</span>
<span id="cb37-2"><a href="experimental-designs.html#cb37-2"></a><span class="op">&gt;</span><span class="st"> </span>treatments=LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] <span class="co"># Define treatments</span></span>
<span id="cb37-3"><a href="experimental-designs.html#cb37-3"></a><span class="op">&gt;</span><span class="st"> </span>design =<span class="st"> </span><span class="kw">design.crd</span>(<span class="dt">trt=</span>treatments, <span class="dt">r=</span><span class="dv">3</span>) <span class="co"># 3 replicates of each treatment</span></span>
<span id="cb37-4"><a href="experimental-designs.html#cb37-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(design<span class="op">$</span>book) <span class="co"># Fieldbook data (only first few lines shown)</span></span>
<span id="cb37-5"><a href="experimental-designs.html#cb37-5"></a><span class="co">##   plots r treatments</span></span>
<span id="cb37-6"><a href="experimental-designs.html#cb37-6"></a><span class="co">## 1   101 1          D</span></span>
<span id="cb37-7"><a href="experimental-designs.html#cb37-7"></a><span class="co">## 2   102 1          A</span></span>
<span id="cb37-8"><a href="experimental-designs.html#cb37-8"></a><span class="co">## 3   103 2          A</span></span>
<span id="cb37-9"><a href="experimental-designs.html#cb37-9"></a><span class="co">## 4   104 1          I</span></span>
<span id="cb37-10"><a href="experimental-designs.html#cb37-10"></a><span class="co">## 5   105 1          E</span></span>
<span id="cb37-11"><a href="experimental-designs.html#cb37-11"></a><span class="co">## 6   106 1          H</span></span></code></pre></div>
<p>Since CRDs only involve your treatments, there are no special considerations to analyze them by <a href="anova.html#anova">ANOVA</a> or <a href="linear-regression.html#linear-regression">Linear Regression</a>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="experimental-designs.html#cb38-1"></a><span class="op">&gt;</span><span class="st"> </span>berries=<span class="kw">read.csv</span>(<span class="st">&#39;data/blueberries.csv&#39;</span>)</span>
<span id="cb38-2"><a href="experimental-designs.html#cb38-2"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lm</span>(resistance <span class="op">~</span><span class="st"> </span>variety, <span class="dt">data=</span>berries)</span>
<span id="cb38-3"><a href="experimental-designs.html#cb38-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel)</span>
<span id="cb38-4"><a href="experimental-designs.html#cb38-4"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb38-5"><a href="experimental-designs.html#cb38-5"></a><span class="co">## </span></span>
<span id="cb38-6"><a href="experimental-designs.html#cb38-6"></a><span class="co">## Response: resistance</span></span>
<span id="cb38-7"><a href="experimental-designs.html#cb38-7"></a><span class="co">##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span></span>
<span id="cb38-8"><a href="experimental-designs.html#cb38-8"></a><span class="co">## variety    5  45.99  9.1980  4.4804 0.00503 **</span></span>
<span id="cb38-9"><a href="experimental-designs.html#cb38-9"></a><span class="co">## Residuals 24  49.27  2.0529                   </span></span>
<span id="cb38-10"><a href="experimental-designs.html#cb38-10"></a><span class="co">## ---</span></span>
<span id="cb38-11"><a href="experimental-designs.html#cb38-11"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="randomized-complete-block-designs" class="section level2">
<h2><span class="header-section-number">4.3</span> Randomized complete block designs</h2>
<p>RCBDs are the workhorses of experimental design. They’re probably the most common overall, and you should probably start with them as your default design and change to something else only if there’s a reason RCBD won’t work.</p>
<p>While you <em>can</em> make your own RCBD using basic R, it’s much easier to let agricolae do it for you</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="experimental-designs.html#cb39-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(agricolae)</span>
<span id="cb39-2"><a href="experimental-designs.html#cb39-2"></a><span class="op">&gt;</span><span class="st"> </span>treatments=LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>] <span class="co"># Define treatments</span></span>
<span id="cb39-3"><a href="experimental-designs.html#cb39-3"></a><span class="op">&gt;</span><span class="st"> </span>design =<span class="st"> </span><span class="kw">design.rcbd</span>(<span class="dt">trt=</span>treatments, <span class="dt">r=</span><span class="dv">3</span>) <span class="co"># 3 replicates of each treatment</span></span>
<span id="cb39-4"><a href="experimental-designs.html#cb39-4"></a><span class="op">&gt;</span><span class="st"> </span>design<span class="op">$</span>sketch <span class="co"># Field layout</span></span>
<span id="cb39-5"><a href="experimental-designs.html#cb39-5"></a><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb39-6"><a href="experimental-designs.html#cb39-6"></a><span class="co">## [1,] &quot;J&quot;  &quot;H&quot;  &quot;F&quot;  &quot;B&quot;  &quot;A&quot;  &quot;D&quot;  &quot;I&quot;  &quot;G&quot;  &quot;E&quot;  &quot;C&quot;  </span></span>
<span id="cb39-7"><a href="experimental-designs.html#cb39-7"></a><span class="co">## [2,] &quot;C&quot;  &quot;D&quot;  &quot;E&quot;  &quot;J&quot;  &quot;B&quot;  &quot;F&quot;  &quot;H&quot;  &quot;A&quot;  &quot;I&quot;  &quot;G&quot;  </span></span>
<span id="cb39-8"><a href="experimental-designs.html#cb39-8"></a><span class="co">## [3,] &quot;H&quot;  &quot;I&quot;  &quot;C&quot;  &quot;D&quot;  &quot;E&quot;  &quot;B&quot;  &quot;G&quot;  &quot;A&quot;  &quot;F&quot;  &quot;J&quot;</span></span>
<span id="cb39-9"><a href="experimental-designs.html#cb39-9"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(design<span class="op">$</span>book) <span class="co"># Fieldbook data (only first few lines shown)</span></span>
<span id="cb39-10"><a href="experimental-designs.html#cb39-10"></a><span class="co">##   plots block treatments</span></span>
<span id="cb39-11"><a href="experimental-designs.html#cb39-11"></a><span class="co">## 1   101     1          J</span></span>
<span id="cb39-12"><a href="experimental-designs.html#cb39-12"></a><span class="co">## 2   102     1          H</span></span>
<span id="cb39-13"><a href="experimental-designs.html#cb39-13"></a><span class="co">## 3   103     1          F</span></span>
<span id="cb39-14"><a href="experimental-designs.html#cb39-14"></a><span class="co">## 4   104     1          B</span></span>
<span id="cb39-15"><a href="experimental-designs.html#cb39-15"></a><span class="co">## 5   105     1          A</span></span>
<span id="cb39-16"><a href="experimental-designs.html#cb39-16"></a><span class="co">## 6   106     1          D</span></span></code></pre></div>
<p>When analyzing RCBDs, make sure to include your block term. If you’re using a fixed-effects model (meaning <strong>lm()</strong>), blocks should go first in your model because they’re a nuisance variable. If using a mixed-effects model, blocks are usually treated as random effects because we don’t care about the specific blocks you used.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="experimental-designs.html#cb40-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Factorial analysis of bananas</span></span>
<span id="cb40-2"><a href="experimental-designs.html#cb40-2"></a><span class="er">&gt;</span><span class="st"> </span>bananas =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/bananas.csv&#39;</span>)</span>
<span id="cb40-3"><a href="experimental-designs.html#cb40-3"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb40-4"><a href="experimental-designs.html#cb40-4"></a><span class="er">&gt;</span><span class="st"> </span><span class="co"># Fixed effects model</span></span>
<span id="cb40-5"><a href="experimental-designs.html#cb40-5"></a><span class="er">&gt;</span><span class="st"> </span>fixed =<span class="st"> </span><span class="kw">lm</span>(resistance <span class="op">~</span><span class="st"> </span>block <span class="op">+</span><span class="st"> </span>variety <span class="op">*</span><span class="st"> </span>fungicide, <span class="dt">data=</span>bananas)</span>
<span id="cb40-6"><a href="experimental-designs.html#cb40-6"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(fixed)</span>
<span id="cb40-7"><a href="experimental-designs.html#cb40-7"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb40-8"><a href="experimental-designs.html#cb40-8"></a><span class="co">## </span></span>
<span id="cb40-9"><a href="experimental-designs.html#cb40-9"></a><span class="co">## Response: resistance</span></span>
<span id="cb40-10"><a href="experimental-designs.html#cb40-10"></a><span class="co">##                   Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb40-11"><a href="experimental-designs.html#cb40-11"></a><span class="co">## block              5  9.5397  1.9079  6.7502 3.462e-05 ***</span></span>
<span id="cb40-12"><a href="experimental-designs.html#cb40-12"></a><span class="co">## variety            4 16.1644  4.0411 14.2973 1.401e-08 ***</span></span>
<span id="cb40-13"><a href="experimental-designs.html#cb40-13"></a><span class="co">## fungicide          2  2.4407  1.2203  4.3175   0.01706 *  </span></span>
<span id="cb40-14"><a href="experimental-designs.html#cb40-14"></a><span class="co">## variety:fungicide  8  4.6349  0.5794  2.0498   0.05276 .  </span></span>
<span id="cb40-15"><a href="experimental-designs.html#cb40-15"></a><span class="co">## Residuals         70 19.7853  0.2826                      </span></span>
<span id="cb40-16"><a href="experimental-designs.html#cb40-16"></a><span class="co">## ---</span></span>
<span id="cb40-17"><a href="experimental-designs.html#cb40-17"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb40-18"><a href="experimental-designs.html#cb40-18"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb40-19"><a href="experimental-designs.html#cb40-19"></a><span class="er">&gt;</span><span class="st"> </span><span class="co"># Mixed effects model</span></span>
<span id="cb40-20"><a href="experimental-designs.html#cb40-20"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">library</span>(lmerTest)</span>
<span id="cb40-21"><a href="experimental-designs.html#cb40-21"></a><span class="co">## Loading required package: lme4</span></span>
<span id="cb40-22"><a href="experimental-designs.html#cb40-22"></a><span class="co">## Loading required package: Matrix</span></span>
<span id="cb40-23"><a href="experimental-designs.html#cb40-23"></a><span class="co">## </span></span>
<span id="cb40-24"><a href="experimental-designs.html#cb40-24"></a><span class="co">## Attaching package: &#39;lmerTest&#39;</span></span>
<span id="cb40-25"><a href="experimental-designs.html#cb40-25"></a><span class="co">## The following object is masked from &#39;package:lme4&#39;:</span></span>
<span id="cb40-26"><a href="experimental-designs.html#cb40-26"></a><span class="co">## </span></span>
<span id="cb40-27"><a href="experimental-designs.html#cb40-27"></a><span class="co">##     lmer</span></span>
<span id="cb40-28"><a href="experimental-designs.html#cb40-28"></a><span class="co">## The following object is masked from &#39;package:stats&#39;:</span></span>
<span id="cb40-29"><a href="experimental-designs.html#cb40-29"></a><span class="co">## </span></span>
<span id="cb40-30"><a href="experimental-designs.html#cb40-30"></a><span class="co">##     step</span></span>
<span id="cb40-31"><a href="experimental-designs.html#cb40-31"></a><span class="op">&gt;</span><span class="st"> </span>mixed =<span class="st"> </span><span class="kw">lmer</span>(resistance <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>block) <span class="op">+</span><span class="st"> </span>variety <span class="op">*</span><span class="st"> </span>fungicide, <span class="dt">data=</span>bananas)</span>
<span id="cb40-32"><a href="experimental-designs.html#cb40-32"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb40-33"><a href="experimental-designs.html#cb40-33"></a><span class="er">&gt;</span><span class="st"> </span><span class="co"># ANOVA of fixed effects</span></span>
<span id="cb40-34"><a href="experimental-designs.html#cb40-34"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mixed) </span>
<span id="cb40-35"><a href="experimental-designs.html#cb40-35"></a><span class="co">## Type III Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb40-36"><a href="experimental-designs.html#cb40-36"></a><span class="co">##                    Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    </span></span>
<span id="cb40-37"><a href="experimental-designs.html#cb40-37"></a><span class="co">## variety           16.1644  4.0411     4    70 14.2973 1.401e-08 ***</span></span>
<span id="cb40-38"><a href="experimental-designs.html#cb40-38"></a><span class="co">## fungicide          2.4407  1.2203     2    70  4.3175   0.01706 *  </span></span>
<span id="cb40-39"><a href="experimental-designs.html#cb40-39"></a><span class="co">## variety:fungicide  4.6349  0.5794     8    70  2.0498   0.05276 .  </span></span>
<span id="cb40-40"><a href="experimental-designs.html#cb40-40"></a><span class="co">## ---</span></span>
<span id="cb40-41"><a href="experimental-designs.html#cb40-41"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb40-42"><a href="experimental-designs.html#cb40-42"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb40-43"><a href="experimental-designs.html#cb40-43"></a><span class="er">&gt;</span><span class="st"> </span><span class="co"># Similar analysis of random effects</span></span>
<span id="cb40-44"><a href="experimental-designs.html#cb40-44"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">ranova</span>(mixed) </span>
<span id="cb40-45"><a href="experimental-designs.html#cb40-45"></a><span class="co">## ANOVA-like table for random-effects: Single term deletions</span></span>
<span id="cb40-46"><a href="experimental-designs.html#cb40-46"></a><span class="co">## </span></span>
<span id="cb40-47"><a href="experimental-designs.html#cb40-47"></a><span class="co">## Model:</span></span>
<span id="cb40-48"><a href="experimental-designs.html#cb40-48"></a><span class="co">## resistance ~ variety + fungicide + (1 | block) + variety:fungicide</span></span>
<span id="cb40-49"><a href="experimental-designs.html#cb40-49"></a><span class="co">##             npar  logLik    AIC   LRT Df Pr(&gt;Chisq)    </span></span>
<span id="cb40-50"><a href="experimental-designs.html#cb40-50"></a><span class="co">## &lt;none&gt;        17 -77.249 188.50                        </span></span>
<span id="cb40-51"><a href="experimental-designs.html#cb40-51"></a><span class="co">## (1 | block)   16 -84.644 201.29 14.79  1  0.0001202 ***</span></span>
<span id="cb40-52"><a href="experimental-designs.html#cb40-52"></a><span class="co">## ---</span></span>
<span id="cb40-53"><a href="experimental-designs.html#cb40-53"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="latin-squares" class="section level2">
<h2><span class="header-section-number">4.4</span> Latin Squares</h2>
<p>Latin squares involve comparing several treatments that all have the same number of levels. While you can do this on your own, it’s much easier to let agricolae do it for you.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="experimental-designs.html#cb41-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(agricolae)</span>
<span id="cb41-2"><a href="experimental-designs.html#cb41-2"></a><span class="op">&gt;</span><span class="st"> </span>treatments=LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb41-3"><a href="experimental-designs.html#cb41-3"></a><span class="op">&gt;</span><span class="st"> </span>design=<span class="kw">design.lsd</span>(<span class="dt">trt=</span>treatments) <span class="co"># Only have to supply the treatment levels</span></span>
<span id="cb41-4"><a href="experimental-designs.html#cb41-4"></a><span class="op">&gt;</span><span class="st"> </span>design<span class="op">$</span>sketch <span class="co"># Field layout</span></span>
<span id="cb41-5"><a href="experimental-designs.html#cb41-5"></a><span class="co">##      [,1] [,2] [,3] [,4]</span></span>
<span id="cb41-6"><a href="experimental-designs.html#cb41-6"></a><span class="co">## [1,] &quot;B&quot;  &quot;C&quot;  &quot;D&quot;  &quot;A&quot; </span></span>
<span id="cb41-7"><a href="experimental-designs.html#cb41-7"></a><span class="co">## [2,] &quot;C&quot;  &quot;D&quot;  &quot;A&quot;  &quot;B&quot; </span></span>
<span id="cb41-8"><a href="experimental-designs.html#cb41-8"></a><span class="co">## [3,] &quot;A&quot;  &quot;B&quot;  &quot;C&quot;  &quot;D&quot; </span></span>
<span id="cb41-9"><a href="experimental-designs.html#cb41-9"></a><span class="co">## [4,] &quot;D&quot;  &quot;A&quot;  &quot;B&quot;  &quot;C&quot;</span></span>
<span id="cb41-10"><a href="experimental-designs.html#cb41-10"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(design<span class="op">$</span>book) <span class="co"># Fieldbook data (only first few lines shown)</span></span>
<span id="cb41-11"><a href="experimental-designs.html#cb41-11"></a><span class="co">##   plots row col treatments</span></span>
<span id="cb41-12"><a href="experimental-designs.html#cb41-12"></a><span class="co">## 1   101   1   1          B</span></span>
<span id="cb41-13"><a href="experimental-designs.html#cb41-13"></a><span class="co">## 2   102   1   2          C</span></span>
<span id="cb41-14"><a href="experimental-designs.html#cb41-14"></a><span class="co">## 3   103   1   3          D</span></span>
<span id="cb41-15"><a href="experimental-designs.html#cb41-15"></a><span class="co">## 4   104   1   4          A</span></span>
<span id="cb41-16"><a href="experimental-designs.html#cb41-16"></a><span class="co">## 5   201   2   1          C</span></span>
<span id="cb41-17"><a href="experimental-designs.html#cb41-17"></a><span class="co">## 6   202   2   2          D</span></span></code></pre></div>
<p>Since pairwise interactions only occur once in a Latin Square, you can only test main effects, not interactions</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="experimental-designs.html#cb42-1"></a><span class="op">&gt;</span><span class="st"> </span>clover =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/clover.csv&quot;</span>)</span>
<span id="cb42-2"><a href="experimental-designs.html#cb42-2"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lm</span>(biomass <span class="op">~</span><span class="st"> </span>location <span class="op">+</span><span class="st"> </span>scorer <span class="op">+</span><span class="st"> </span>variety, <span class="dt">data=</span>clover)</span>
<span id="cb42-3"><a href="experimental-designs.html#cb42-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel)</span>
<span id="cb42-4"><a href="experimental-designs.html#cb42-4"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb42-5"><a href="experimental-designs.html#cb42-5"></a><span class="co">## </span></span>
<span id="cb42-6"><a href="experimental-designs.html#cb42-6"></a><span class="co">## Response: biomass</span></span>
<span id="cb42-7"><a href="experimental-designs.html#cb42-7"></a><span class="co">##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb42-8"><a href="experimental-designs.html#cb42-8"></a><span class="co">## location   4  46.86  11.716  6.1434  0.006277 ** </span></span>
<span id="cb42-9"><a href="experimental-designs.html#cb42-9"></a><span class="co">## scorer     4  19.41   4.853  2.5450  0.094148 .  </span></span>
<span id="cb42-10"><a href="experimental-designs.html#cb42-10"></a><span class="co">## variety    4 348.51  87.127 45.6870 3.629e-07 ***</span></span>
<span id="cb42-11"><a href="experimental-designs.html#cb42-11"></a><span class="co">## Residuals 12  22.88   1.907                      </span></span>
<span id="cb42-12"><a href="experimental-designs.html#cb42-12"></a><span class="co">## ---</span></span>
<span id="cb42-13"><a href="experimental-designs.html#cb42-13"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="graeco-latin-squares" class="section level2">
<h2><span class="header-section-number">4.5</span> Graeco-Latin Squares</h2>
<p>Graeco-Latin squares are just Latin Squares with an extra main effect added on, so that all pairwise combinations still occur once. Although in theory you can layer these many layers deep (with 6, 7, 8, etc. effects you’re testing), in practice you really don’t want to go deeper than four (row, column, treatment 1, treatment 2). Probably for this reason, agricolae only does the most basic Graeco-Latin Square:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="experimental-designs.html#cb43-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(agricolae)</span>
<span id="cb43-2"><a href="experimental-designs.html#cb43-2"></a><span class="op">&gt;</span><span class="st"> </span>treat1=LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span>
<span id="cb43-3"><a href="experimental-designs.html#cb43-3"></a><span class="op">&gt;</span><span class="st"> </span>treat2=LETTERS[<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]</span>
<span id="cb43-4"><a href="experimental-designs.html#cb43-4"></a><span class="op">&gt;</span><span class="st"> </span>design=<span class="kw">design.graeco</span>(<span class="dt">trt1=</span>treat1, <span class="dt">trt2=</span>treat2) </span>
<span id="cb43-5"><a href="experimental-designs.html#cb43-5"></a><span class="op">&gt;</span><span class="st"> </span>design<span class="op">$</span>sketch <span class="co"># Field layout</span></span>
<span id="cb43-6"><a href="experimental-designs.html#cb43-6"></a><span class="co">##      [,1]  [,2]  [,3]  [,4] </span></span>
<span id="cb43-7"><a href="experimental-designs.html#cb43-7"></a><span class="co">## [1,] &quot;D F&quot; &quot;C E&quot; &quot;A H&quot; &quot;B G&quot;</span></span>
<span id="cb43-8"><a href="experimental-designs.html#cb43-8"></a><span class="co">## [2,] &quot;C H&quot; &quot;D G&quot; &quot;B F&quot; &quot;A E&quot;</span></span>
<span id="cb43-9"><a href="experimental-designs.html#cb43-9"></a><span class="co">## [3,] &quot;A G&quot; &quot;B H&quot; &quot;D E&quot; &quot;C F&quot;</span></span>
<span id="cb43-10"><a href="experimental-designs.html#cb43-10"></a><span class="co">## [4,] &quot;B E&quot; &quot;A F&quot; &quot;C G&quot; &quot;D H&quot;</span></span>
<span id="cb43-11"><a href="experimental-designs.html#cb43-11"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(design<span class="op">$</span>book) <span class="co"># Fieldbook data (only first few lines shown)</span></span>
<span id="cb43-12"><a href="experimental-designs.html#cb43-12"></a><span class="co">##   plots row col treat1 treat2</span></span>
<span id="cb43-13"><a href="experimental-designs.html#cb43-13"></a><span class="co">## 1   101   1   1      D      F</span></span>
<span id="cb43-14"><a href="experimental-designs.html#cb43-14"></a><span class="co">## 2   102   1   2      C      E</span></span>
<span id="cb43-15"><a href="experimental-designs.html#cb43-15"></a><span class="co">## 3   103   1   3      A      H</span></span>
<span id="cb43-16"><a href="experimental-designs.html#cb43-16"></a><span class="co">## 4   104   1   4      B      G</span></span>
<span id="cb43-17"><a href="experimental-designs.html#cb43-17"></a><span class="co">## 5   201   2   1      C      H</span></span>
<span id="cb43-18"><a href="experimental-designs.html#cb43-18"></a><span class="co">## 6   202   2   2      D      G</span></span></code></pre></div>
<p>Analysis of Graeco-Latin squares is identical to Latin Squares, with the only real constraint being that you can only test main effects, not interactions.</p>
</div>
<div id="balanced-incomplete-block-designs" class="section level2">
<h2><span class="header-section-number">4.6</span> Balanced Incomplete Block Designs</h2>
<p>BIBD can be easily constructed in agricolae, assuming the parameters you’ve chosen are compatible. (Not all combinations of treatment levels, reps, and block size can actually give a working BIBD.)</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="experimental-designs.html#cb44-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Make a basic BIBD</span></span>
<span id="cb44-2"><a href="experimental-designs.html#cb44-2"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">library</span>(agricolae)</span>
<span id="cb44-3"><a href="experimental-designs.html#cb44-3"></a><span class="op">&gt;</span><span class="st"> </span>treatments =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb44-4"><a href="experimental-designs.html#cb44-4"></a><span class="op">&gt;</span><span class="st"> </span>bibd =<span class="st"> </span><span class="kw">design.bib</span>(<span class="dt">trt=</span>treatments, <span class="dt">k=</span><span class="dv">3</span>) <span class="co"># R will find smallest # of reps that works</span></span>
<span id="cb44-5"><a href="experimental-designs.html#cb44-5"></a><span class="co">## </span></span>
<span id="cb44-6"><a href="experimental-designs.html#cb44-6"></a><span class="co">## Parameters BIB</span></span>
<span id="cb44-7"><a href="experimental-designs.html#cb44-7"></a><span class="co">## ==============</span></span>
<span id="cb44-8"><a href="experimental-designs.html#cb44-8"></a><span class="co">## Lambda     : 2</span></span>
<span id="cb44-9"><a href="experimental-designs.html#cb44-9"></a><span class="co">## treatmeans : 4</span></span>
<span id="cb44-10"><a href="experimental-designs.html#cb44-10"></a><span class="co">## Block size : 3</span></span>
<span id="cb44-11"><a href="experimental-designs.html#cb44-11"></a><span class="co">## Blocks     : 4</span></span>
<span id="cb44-12"><a href="experimental-designs.html#cb44-12"></a><span class="co">## Replication: 3 </span></span>
<span id="cb44-13"><a href="experimental-designs.html#cb44-13"></a><span class="co">## </span></span>
<span id="cb44-14"><a href="experimental-designs.html#cb44-14"></a><span class="co">## Efficiency factor 0.8888889 </span></span>
<span id="cb44-15"><a href="experimental-designs.html#cb44-15"></a><span class="co">## </span></span>
<span id="cb44-16"><a href="experimental-designs.html#cb44-16"></a><span class="co">## &lt;&lt;&lt; Book &gt;&gt;&gt;</span></span>
<span id="cb44-17"><a href="experimental-designs.html#cb44-17"></a><span class="op">&gt;</span><span class="st"> </span>bibd<span class="op">$</span>sketch <span class="co"># Check layout</span></span>
<span id="cb44-18"><a href="experimental-designs.html#cb44-18"></a><span class="co">##      [,1] [,2] [,3]</span></span>
<span id="cb44-19"><a href="experimental-designs.html#cb44-19"></a><span class="co">## [1,] &quot;A&quot;  &quot;D&quot;  &quot;C&quot; </span></span>
<span id="cb44-20"><a href="experimental-designs.html#cb44-20"></a><span class="co">## [2,] &quot;C&quot;  &quot;A&quot;  &quot;B&quot; </span></span>
<span id="cb44-21"><a href="experimental-designs.html#cb44-21"></a><span class="co">## [3,] &quot;A&quot;  &quot;B&quot;  &quot;D&quot; </span></span>
<span id="cb44-22"><a href="experimental-designs.html#cb44-22"></a><span class="co">## [4,] &quot;D&quot;  &quot;C&quot;  &quot;B&quot;</span></span>
<span id="cb44-23"><a href="experimental-designs.html#cb44-23"></a><span class="op">&gt;</span><span class="st"> </span>bibd<span class="op">$</span>book <span class="co"># Fieldbook table</span></span>
<span id="cb44-24"><a href="experimental-designs.html#cb44-24"></a><span class="co">##    plots block treatments</span></span>
<span id="cb44-25"><a href="experimental-designs.html#cb44-25"></a><span class="co">## 1    101     1          A</span></span>
<span id="cb44-26"><a href="experimental-designs.html#cb44-26"></a><span class="co">## 2    102     1          D</span></span>
<span id="cb44-27"><a href="experimental-designs.html#cb44-27"></a><span class="co">## 3    103     1          C</span></span>
<span id="cb44-28"><a href="experimental-designs.html#cb44-28"></a><span class="co">## 4    201     2          C</span></span>
<span id="cb44-29"><a href="experimental-designs.html#cb44-29"></a><span class="co">## 5    202     2          A</span></span>
<span id="cb44-30"><a href="experimental-designs.html#cb44-30"></a><span class="co">## 6    203     2          B</span></span>
<span id="cb44-31"><a href="experimental-designs.html#cb44-31"></a><span class="co">## 7    301     3          A</span></span>
<span id="cb44-32"><a href="experimental-designs.html#cb44-32"></a><span class="co">## 8    302     3          B</span></span>
<span id="cb44-33"><a href="experimental-designs.html#cb44-33"></a><span class="co">## 9    303     3          D</span></span>
<span id="cb44-34"><a href="experimental-designs.html#cb44-34"></a><span class="co">## 10   401     4          D</span></span>
<span id="cb44-35"><a href="experimental-designs.html#cb44-35"></a><span class="co">## 11   402     4          C</span></span>
<span id="cb44-36"><a href="experimental-designs.html#cb44-36"></a><span class="co">## 12   403     4          B</span></span>
<span id="cb44-37"><a href="experimental-designs.html#cb44-37"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb44-38"><a href="experimental-designs.html#cb44-38"></a><span class="er">&gt;</span><span class="st"> </span></span>
<span id="cb44-39"><a href="experimental-designs.html#cb44-39"></a><span class="er">&gt;</span><span class="st"> </span><span class="co"># Wrong number of reps</span></span>
<span id="cb44-40"><a href="experimental-designs.html#cb44-40"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">design.bib</span>(<span class="dt">trt=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">k=</span><span class="dv">4</span>, <span class="dt">r=</span><span class="dv">3</span>)</span>
<span id="cb44-41"><a href="experimental-designs.html#cb44-41"></a><span class="co">## </span></span>
<span id="cb44-42"><a href="experimental-designs.html#cb44-42"></a><span class="co">##  Change r by  7, 14 ...</span></span>
<span id="cb44-43"><a href="experimental-designs.html#cb44-43"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Poor value of k</span></span>
<span id="cb44-44"><a href="experimental-designs.html#cb44-44"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">design.bib</span>(<span class="dt">trt=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">k=</span><span class="dv">6</span>, <span class="dt">r=</span><span class="dv">3</span>)</span>
<span id="cb44-45"><a href="experimental-designs.html#cb44-45"></a><span class="co">## Other k &lt;&gt;  6 ; 1&lt;k&lt; 8</span></span>
<span id="cb44-46"><a href="experimental-designs.html#cb44-46"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Just plain error</span></span>
<span id="cb44-47"><a href="experimental-designs.html#cb44-47"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">design.bib</span>(<span class="dt">trt=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">k=</span><span class="dv">5</span>)</span>
<span id="cb44-48"><a href="experimental-designs.html#cb44-48"></a><span class="co">## Error in rep(k, b): invalid &#39;times&#39; argument</span></span></code></pre></div>
<p>Analyzing a BIBD is pretty straightforward to analyze, since it’s just an experiment parcelled out into incomplete blocks.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="experimental-designs.html#cb45-1"></a><span class="op">&gt;</span><span class="st"> </span>onions =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/onions.csv&quot;</span>)</span>
<span id="cb45-2"><a href="experimental-designs.html#cb45-2"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lm</span>(disease <span class="op">~</span><span class="st"> </span>block <span class="op">+</span><span class="st"> </span>variety, <span class="dt">data=</span>onions)</span>
<span id="cb45-3"><a href="experimental-designs.html#cb45-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel)</span>
<span id="cb45-4"><a href="experimental-designs.html#cb45-4"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb45-5"><a href="experimental-designs.html#cb45-5"></a><span class="co">## </span></span>
<span id="cb45-6"><a href="experimental-designs.html#cb45-6"></a><span class="co">## Response: disease</span></span>
<span id="cb45-7"><a href="experimental-designs.html#cb45-7"></a><span class="co">##           Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span>
<span id="cb45-8"><a href="experimental-designs.html#cb45-8"></a><span class="co">## block      9 7.1787 0.79763  2.1811 0.08318 .</span></span>
<span id="cb45-9"><a href="experimental-designs.html#cb45-9"></a><span class="co">## variety    4 4.5489 1.13722  3.1098 0.04516 *</span></span>
<span id="cb45-10"><a href="experimental-designs.html#cb45-10"></a><span class="co">## Residuals 16 5.8511 0.36569                  </span></span>
<span id="cb45-11"><a href="experimental-designs.html#cb45-11"></a><span class="co">## ---</span></span>
<span id="cb45-12"><a href="experimental-designs.html#cb45-12"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="confounded-designs" class="section level2">
<h2><span class="header-section-number">4.7</span> Confounded designs</h2>
<p>Building a confounded design requires a little work with the <a href="https://cran.r-project.org/package=conf.design">conf.design</a> package. It’s kind of tricky because you have to specify which things are confounded, then do the replication and randomization yourself. You won’t need to make your own confounded designs in this class for that reason.</p>
<p><em>Analyzing</em> a confounded design, however, is straightforward and follows the same pattern as RCBD, BIBD, Latin Squares, etc. Just be aware that you won’t be able to test whatever effect(s) you confounded (unless it’s only a partially confounded design).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="experimental-designs.html#cb46-1"></a><span class="op">&gt;</span><span class="st"> </span>mydata =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/confounded.csv&quot;</span>)</span>
<span id="cb46-2"><a href="experimental-designs.html#cb46-2"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lm</span>(disease <span class="op">~</span><span class="st"> </span>covercrop <span class="op">*</span><span class="st"> </span>solarize, <span class="dt">data=</span>mydata)</span>
<span id="cb46-3"><a href="experimental-designs.html#cb46-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel)</span>
<span id="cb46-4"><a href="experimental-designs.html#cb46-4"></a><span class="co">## Analysis of Variance Table</span></span>
<span id="cb46-5"><a href="experimental-designs.html#cb46-5"></a><span class="co">## </span></span>
<span id="cb46-6"><a href="experimental-designs.html#cb46-6"></a><span class="co">## Response: disease</span></span>
<span id="cb46-7"><a href="experimental-designs.html#cb46-7"></a><span class="co">##                    Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span>
<span id="cb46-8"><a href="experimental-designs.html#cb46-8"></a><span class="co">## covercrop           1 14.098  14.098  2.1248 0.21867  </span></span>
<span id="cb46-9"><a href="experimental-designs.html#cb46-9"></a><span class="co">## solarize            1 79.758  79.758 12.0209 0.02565 *</span></span>
<span id="cb46-10"><a href="experimental-designs.html#cb46-10"></a><span class="co">## covercrop:solarize  1 46.465  46.465  7.0030 0.05720 .</span></span>
<span id="cb46-11"><a href="experimental-designs.html#cb46-11"></a><span class="co">## Residuals           4 26.540   6.635                  </span></span>
<span id="cb46-12"><a href="experimental-designs.html#cb46-12"></a><span class="co">## ---</span></span>
<span id="cb46-13"><a href="experimental-designs.html#cb46-13"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="split-plot-designs" class="section level2">
<h2><span class="header-section-number">4.8</span> Split-plot designs</h2>
<p>Split-plot designs involve using one of your main effects as a blocking factor, usually because it’s hard to change. Split-plots can be generated in agricolae by specifying the two treatments, number of reps, and the design for the whole plots</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="experimental-designs.html#cb47-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(agricolae)</span>
<span id="cb47-2"><a href="experimental-designs.html#cb47-2"></a><span class="op">&gt;</span><span class="st"> </span>wholeplot=<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb47-3"><a href="experimental-designs.html#cb47-3"></a><span class="op">&gt;</span><span class="st"> </span>subplot=<span class="kw">c</span>(<span class="st">&quot;test1&quot;</span>, <span class="st">&quot;test2&quot;</span>, <span class="st">&quot;test3&quot;</span>,<span class="st">&quot;test4&quot;</span>, <span class="st">&quot;test5&quot;</span>)</span>
<span id="cb47-4"><a href="experimental-designs.html#cb47-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="co"># Make a design with whole plots in RCBD with 3 reps</span></span>
<span id="cb47-5"><a href="experimental-designs.html#cb47-5"></a><span class="er">&gt;</span><span class="st"> </span>mydesign =<span class="st"> </span><span class="kw">design.split</span>(<span class="dt">trt1=</span>wholeplot, <span class="dt">trt2=</span>subplot, <span class="dt">r=</span><span class="dv">3</span>, <span class="dt">design=</span><span class="st">&#39;rcbd&#39;</span>)</span>
<span id="cb47-6"><a href="experimental-designs.html#cb47-6"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(mydesign<span class="op">$</span>book)</span>
<span id="cb47-7"><a href="experimental-designs.html#cb47-7"></a><span class="co">##   plots splots block wholeplot subplot</span></span>
<span id="cb47-8"><a href="experimental-designs.html#cb47-8"></a><span class="co">## 1   101      1     1         A   test1</span></span>
<span id="cb47-9"><a href="experimental-designs.html#cb47-9"></a><span class="co">## 2   101      2     1         A   test2</span></span>
<span id="cb47-10"><a href="experimental-designs.html#cb47-10"></a><span class="co">## 3   101      3     1         A   test4</span></span>
<span id="cb47-11"><a href="experimental-designs.html#cb47-11"></a><span class="co">## 4   101      4     1         A   test3</span></span>
<span id="cb47-12"><a href="experimental-designs.html#cb47-12"></a><span class="co">## 5   101      5     1         A   test5</span></span>
<span id="cb47-13"><a href="experimental-designs.html#cb47-13"></a><span class="co">## 6   102      1     1         C   test1</span></span></code></pre></div>
<p>Since all the measurements within each whole-plot are correlated with each other, we need to account for that in our analyses. Although you can specify additional error terms with <a href="anova.html#aov">aov()</a>, it’s easier to just use <a href="linear-regression.html#random-effects-and-lme4">random effects and lme4</a> with lmer().</p>
<p><strong>Note:</strong> Make sure each unique whole-plot has a unique label so that they are treated correctly.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="experimental-designs.html#cb48-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(lmerTest)</span>
<span id="cb48-2"><a href="experimental-designs.html#cb48-2"></a><span class="op">&gt;</span><span class="st"> </span>mydata =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/splitplot.csv&#39;</span>) <span class="co"># CRD, so no block effect</span></span>
<span id="cb48-3"><a href="experimental-designs.html#cb48-3"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lmer</span>(yield <span class="op">~</span><span class="st"> </span>fertilizer <span class="op">*</span><span class="st"> </span>variety <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>wholeplot), <span class="dt">data=</span>mydata)</span>
<span id="cb48-4"><a href="experimental-designs.html#cb48-4"></a><span class="co">## boundary (singular) fit: see ?isSingular</span></span>
<span id="cb48-5"><a href="experimental-designs.html#cb48-5"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel) <span class="co"># Fixed effect ANOVA</span></span>
<span id="cb48-6"><a href="experimental-designs.html#cb48-6"></a><span class="co">## Type III Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb48-7"><a href="experimental-designs.html#cb48-7"></a><span class="co">##                    Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    </span></span>
<span id="cb48-8"><a href="experimental-designs.html#cb48-8"></a><span class="co">## fertilizer         452.40  452.40     1    16 343.5962 3.078e-12 ***</span></span>
<span id="cb48-9"><a href="experimental-designs.html#cb48-9"></a><span class="co">## variety            159.38   53.13     3    16  40.3494 1.091e-07 ***</span></span>
<span id="cb48-10"><a href="experimental-designs.html#cb48-10"></a><span class="co">## fertilizer:variety  17.13    5.71     3    16   4.3354    0.0204 *  </span></span>
<span id="cb48-11"><a href="experimental-designs.html#cb48-11"></a><span class="co">## ---</span></span>
<span id="cb48-12"><a href="experimental-designs.html#cb48-12"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb48-13"><a href="experimental-designs.html#cb48-13"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb48-14"><a href="experimental-designs.html#cb48-14"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">ranova</span>(mymodel) <span class="co"># Random effect test (similar to ANOVA)</span></span>
<span id="cb48-15"><a href="experimental-designs.html#cb48-15"></a><span class="co">## ANOVA-like table for random-effects: Single term deletions</span></span>
<span id="cb48-16"><a href="experimental-designs.html#cb48-16"></a><span class="co">## </span></span>
<span id="cb48-17"><a href="experimental-designs.html#cb48-17"></a><span class="co">## Model:</span></span>
<span id="cb48-18"><a href="experimental-designs.html#cb48-18"></a><span class="co">## yield ~ fertilizer + variety + (1 | wholeplot) + fertilizer:variety</span></span>
<span id="cb48-19"><a href="experimental-designs.html#cb48-19"></a><span class="co">##                 npar  logLik    AIC         LRT Df Pr(&gt;Chisq)</span></span>
<span id="cb48-20"><a href="experimental-designs.html#cb48-20"></a><span class="co">## &lt;none&gt;            10 -29.298 78.597                          </span></span>
<span id="cb48-21"><a href="experimental-designs.html#cb48-21"></a><span class="co">## (1 | wholeplot)    9 -29.298 76.597 -7.1054e-15  1          1</span></span></code></pre></div>
<p>If the whole-plots are in a RCBD design, make sure to include the blocks in the model as well.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="experimental-designs.html#cb49-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(lmerTest)</span>
<span id="cb49-2"><a href="experimental-designs.html#cb49-2"></a><span class="op">&gt;</span><span class="st"> </span>mydata =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/splitplot_rcbd.csv&#39;</span>) </span>
<span id="cb49-3"><a href="experimental-designs.html#cb49-3"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lmer</span>(yield <span class="op">~</span><span class="st"> </span>fertilizer <span class="op">*</span><span class="st"> </span>variety <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>block) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>wholeplot), <span class="dt">data=</span>mydata)</span>
<span id="cb49-4"><a href="experimental-designs.html#cb49-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel) <span class="co"># Fixed effect ANOVA</span></span>
<span id="cb49-5"><a href="experimental-designs.html#cb49-5"></a><span class="co">## Type III Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb49-6"><a href="experimental-designs.html#cb49-6"></a><span class="co">##                    Sum Sq Mean Sq NumDF DenDF  F value    Pr(&gt;F)    </span></span>
<span id="cb49-7"><a href="experimental-designs.html#cb49-7"></a><span class="co">## fertilizer         224.97 112.487     2     4 104.1275 0.0003551 ***</span></span>
<span id="cb49-8"><a href="experimental-designs.html#cb49-8"></a><span class="co">## variety            500.88 125.221     4    24 115.9153 2.505e-15 ***</span></span>
<span id="cb49-9"><a href="experimental-designs.html#cb49-9"></a><span class="co">## fertilizer:variety  43.67   5.459     8    24   5.0536 0.0009221 ***</span></span>
<span id="cb49-10"><a href="experimental-designs.html#cb49-10"></a><span class="co">## ---</span></span>
<span id="cb49-11"><a href="experimental-designs.html#cb49-11"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb49-12"><a href="experimental-designs.html#cb49-12"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb49-13"><a href="experimental-designs.html#cb49-13"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">ranova</span>(mymodel) <span class="co"># Random effect test (similar to ANOVA)</span></span>
<span id="cb49-14"><a href="experimental-designs.html#cb49-14"></a><span class="co">## ANOVA-like table for random-effects: Single term deletions</span></span>
<span id="cb49-15"><a href="experimental-designs.html#cb49-15"></a><span class="co">## </span></span>
<span id="cb49-16"><a href="experimental-designs.html#cb49-16"></a><span class="co">## Model:</span></span>
<span id="cb49-17"><a href="experimental-designs.html#cb49-17"></a><span class="co">## yield ~ fertilizer + variety + (1 | block) + (1 | wholeplot) + </span></span>
<span id="cb49-18"><a href="experimental-designs.html#cb49-18"></a><span class="co">##     fertilizer:variety</span></span>
<span id="cb49-19"><a href="experimental-designs.html#cb49-19"></a><span class="co">##                 npar  logLik    AIC    LRT Df Pr(&gt;Chisq)  </span></span>
<span id="cb49-20"><a href="experimental-designs.html#cb49-20"></a><span class="co">## &lt;none&gt;            18 -56.944 149.89                       </span></span>
<span id="cb49-21"><a href="experimental-designs.html#cb49-21"></a><span class="co">## (1 | block)       17 -59.320 152.64 4.7522  1    0.02926 *</span></span>
<span id="cb49-22"><a href="experimental-designs.html#cb49-22"></a><span class="co">## (1 | wholeplot)   17 -57.570 149.14 1.2508  1    0.26340  </span></span>
<span id="cb49-23"><a href="experimental-designs.html#cb49-23"></a><span class="co">## ---</span></span>
<span id="cb49-24"><a href="experimental-designs.html#cb49-24"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="strip-plot-designs" class="section level2">
<h2><span class="header-section-number">4.9</span> Strip-plot designs</h2>
<p>Strip-plots are almost identical to split-splots, except you have two whole-plot random effects (one for each strip), plus another one for blocks if they are arranged in RCBD (which they usually are).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="experimental-designs.html#cb50-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(lmerTest)</span>
<span id="cb50-2"><a href="experimental-designs.html#cb50-2"></a><span class="op">&gt;</span><span class="st"> </span>mydata =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/strip_plot.csv&#39;</span>) </span>
<span id="cb50-3"><a href="experimental-designs.html#cb50-3"></a><span class="op">&gt;</span><span class="st"> </span>mymodel =<span class="st"> </span><span class="kw">lmer</span>(disease <span class="op">~</span><span class="st"> </span>fertilizer <span class="op">*</span><span class="st"> </span>irrigation <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>block) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>strip1) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>strip2), <span class="dt">data=</span>mydata)</span>
<span id="cb50-4"><a href="experimental-designs.html#cb50-4"></a><span class="co">## boundary (singular) fit: see ?isSingular</span></span>
<span id="cb50-5"><a href="experimental-designs.html#cb50-5"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">anova</span>(mymodel) <span class="co"># Fixed effect ANOVA</span></span>
<span id="cb50-6"><a href="experimental-designs.html#cb50-6"></a><span class="co">## Type III Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb50-7"><a href="experimental-designs.html#cb50-7"></a><span class="co">##                        Sum Sq Mean Sq NumDF   DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb50-8"><a href="experimental-designs.html#cb50-8"></a><span class="co">## fertilizer            118.827  59.414     2  6.8856  6.9135 0.02256 *</span></span>
<span id="cb50-9"><a href="experimental-designs.html#cb50-9"></a><span class="co">## irrigation             43.898  21.949     2  7.5786  2.5541 0.14194  </span></span>
<span id="cb50-10"><a href="experimental-designs.html#cb50-10"></a><span class="co">## fertilizer:irrigation  87.991  21.998     4 11.8864  2.5597 0.09341 .</span></span>
<span id="cb50-11"><a href="experimental-designs.html#cb50-11"></a><span class="co">## ---</span></span>
<span id="cb50-12"><a href="experimental-designs.html#cb50-12"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb50-13"><a href="experimental-designs.html#cb50-13"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb50-14"><a href="experimental-designs.html#cb50-14"></a><span class="er">&gt;</span><span class="st"> </span><span class="kw">ranova</span>(mymodel) <span class="co"># Random effect test (similar to ANOVA)</span></span>
<span id="cb50-15"><a href="experimental-designs.html#cb50-15"></a><span class="co">## ANOVA-like table for random-effects: Single term deletions</span></span>
<span id="cb50-16"><a href="experimental-designs.html#cb50-16"></a><span class="co">## </span></span>
<span id="cb50-17"><a href="experimental-designs.html#cb50-17"></a><span class="co">## Model:</span></span>
<span id="cb50-18"><a href="experimental-designs.html#cb50-18"></a><span class="co">## disease ~ fertilizer + irrigation + (1 | block) + (1 | strip1) + </span></span>
<span id="cb50-19"><a href="experimental-designs.html#cb50-19"></a><span class="co">##     (1 | strip2) + fertilizer:irrigation</span></span>
<span id="cb50-20"><a href="experimental-designs.html#cb50-20"></a><span class="co">##              npar  logLik    AIC    LRT Df Pr(&gt;Chisq)  </span></span>
<span id="cb50-21"><a href="experimental-designs.html#cb50-21"></a><span class="co">## &lt;none&gt;         13 -82.829 191.66                       </span></span>
<span id="cb50-22"><a href="experimental-designs.html#cb50-22"></a><span class="co">## (1 | block)    12 -82.829 189.66 0.0000  1    1.00000  </span></span>
<span id="cb50-23"><a href="experimental-designs.html#cb50-23"></a><span class="co">## (1 | strip1)   12 -83.864 191.73 2.0714  1    0.15008  </span></span>
<span id="cb50-24"><a href="experimental-designs.html#cb50-24"></a><span class="co">## (1 | strip2)   12 -84.804 193.61 3.9517  1    0.04682 *</span></span>
<span id="cb50-25"><a href="experimental-designs.html#cb50-25"></a><span class="co">## ---</span></span>
<span id="cb50-26"><a href="experimental-designs.html#cb50-26"></a><span class="co">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="augmented-designs" class="section level2">
<h2><span class="header-section-number">4.10</span> Augmented designs</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-tools.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
